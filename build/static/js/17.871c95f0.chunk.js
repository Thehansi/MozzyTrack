(this["webpackJsonpdatta-able-rv18.0.4"]=this["webpackJsonpdatta-able-rv18.0.4"]||[]).push([[17],{452:function(e,t,a){"use strict";var o=a(30),n=a(11),r=a(12),i=a(16),l=a(17),s=a(37),c=a.n(s),d=a(895),u=a(860),p=a(473),m=(a(457),a(367)),f=a(455),h=function(e){Object(i.a)(a,e);var t=Object(l.a)(a);function a(){var e;Object(n.a)(this,a);for(var o=arguments.length,r=new Array(o),i=0;i<o;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).state={isOption:e.props.isOption,fullCard:!1,collapseCard:!1,loadCard:!1,cardRemove:!1},e.cardReloadHandler=function(){e.setState({loadCard:!0}),setInterval((function(){e.setState({loadCard:!1})}),3e3)},e.cardRemoveHandler=function(){e.setState({cardRemove:!0})},e}return Object(r.a)(a,[{key:"render",value:function(){var e,t,a,n,r,i=this,l=[];return this.state.isOption&&(a=c.a.createElement("div",{className:"card-header-right"},c.a.createElement(d.a,{alignRight:!0,className:"btn-group card-option"},c.a.createElement(d.a.Toggle,{id:"dropdown-basic",className:"btn-icon"},c.a.createElement("i",{className:"feather icon-more-horizontal"})),c.a.createElement(d.a.Menu,{as:"ul",className:"list-unstyled card-option"},c.a.createElement(d.a.Item,{as:"li",className:"dropdown-item",onClick:function(){i.setState((function(e){return{fullCard:!e.fullCard}}))}},c.a.createElement("i",{className:this.state.fullCard?"feather icon-minimize":"feather icon-maximize"}),c.a.createElement("a",{href:f.a.BLANK_LINK}," ",this.state.fullCard?"Restore":"Maximize"," ")),c.a.createElement(d.a.Item,{as:"li",className:"dropdown-item",onClick:function(){i.setState((function(e){return{collapseCard:!e.collapseCard}}))}},c.a.createElement("i",{className:this.state.collapseCard?"feather icon-plus":"feather icon-minus"}),c.a.createElement("a",{href:f.a.BLANK_LINK}," ",this.state.collapseCard?"Expand":"Collapse"," ")),c.a.createElement(d.a.Item,{as:"li",className:"dropdown-item",onClick:this.cardReloadHandler},c.a.createElement("i",{className:"feather icon-refresh-cw"}),c.a.createElement("a",{href:f.a.BLANK_LINK}," Reload ")),c.a.createElement(d.a.Item,{as:"li",className:"dropdown-item",onClick:this.cardRemoveHandler},c.a.createElement("i",{className:"feather icon-trash"}),c.a.createElement("a",{href:f.a.BLANK_LINK}," Remove ")))))),n=c.a.createElement(u.a.Header,null,c.a.createElement(u.a.Title,{as:"h5"},this.props.title),a),this.state.fullCard&&(l=[].concat(Object(o.a)(l),["full-card"]),e={position:"fixed",top:0,left:0,right:0,width:this.props.windowWidth,height:this.props.windowHeight}),this.state.loadCard&&(l=[].concat(Object(o.a)(l),["card-load"]),t=c.a.createElement("div",{className:"card-loader"},c.a.createElement("i",{className:"pct-loader1 anim-rotate"}))),this.state.cardRemove&&(l=[].concat(Object(o.a)(l),["d-none"])),this.props.cardClass&&(l=[].concat(Object(o.a)(l),[this.props.cardClass])),r=c.a.createElement(u.a,{className:l.join(" "),style:e},n,c.a.createElement(p.a,{in:!this.state.collapseCard},c.a.createElement("div",null,c.a.createElement(u.a.Body,{style:{backgroundColor:"rgb(185, 210, 214)"}},this.props.children))),t),c.a.createElement(m.a,null,r)}}]),a}(s.Component);t.a=h},483:function(e,t,a){var o=a(500),n=a(501),r=n;r.v1=o,r.v4=n,e.exports=r},484:function(e,t){var a="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(a){var o=new Uint8Array(16);e.exports=function(){return a(o),o}}else{var n=new Array(16);e.exports=function(){for(var e,t=0;t<16;t++)0===(3&t)&&(e=4294967296*Math.random()),n[t]=e>>>((3&t)<<3)&255;return n}}},485:function(e,t){for(var a=[],o=0;o<256;++o)a[o]=(o+256).toString(16).substr(1);e.exports=function(e,t){var o=t||0,n=a;return[n[e[o++]],n[e[o++]],n[e[o++]],n[e[o++]],"-",n[e[o++]],n[e[o++]],"-",n[e[o++]],n[e[o++]],"-",n[e[o++]],n[e[o++]],"-",n[e[o++]],n[e[o++]],n[e[o++]],n[e[o++]],n[e[o++]],n[e[o++]]].join("")}},500:function(e,t,a){var o,n,r=a(484),i=a(485),l=0,s=0;e.exports=function(e,t,a){var c=t&&a||0,d=t||[],u=(e=e||{}).node||o,p=void 0!==e.clockseq?e.clockseq:n;if(null==u||null==p){var m=r();null==u&&(u=o=[1|m[0],m[1],m[2],m[3],m[4],m[5]]),null==p&&(p=n=16383&(m[6]<<8|m[7]))}var f=void 0!==e.msecs?e.msecs:(new Date).getTime(),h=void 0!==e.nsecs?e.nsecs:s+1,y=f-l+(h-s)/1e4;if(y<0&&void 0===e.clockseq&&(p=p+1&16383),(y<0||f>l)&&void 0===e.nsecs&&(h=0),h>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");l=f,s=h,n=p;var g=(1e4*(268435455&(f+=122192928e5))+h)%4294967296;d[c++]=g>>>24&255,d[c++]=g>>>16&255,d[c++]=g>>>8&255,d[c++]=255&g;var v=f/4294967296*1e4&268435455;d[c++]=v>>>8&255,d[c++]=255&v,d[c++]=v>>>24&15|16,d[c++]=v>>>16&255,d[c++]=p>>>8|128,d[c++]=255&p;for(var E=0;E<6;++E)d[c+E]=u[E];return t||i(d)}},501:function(e,t,a){var o=a(484),n=a(485);e.exports=function(e,t,a){var r=t&&a||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var i=(e=e||{}).random||(e.rng||o)();if(i[6]=15&i[6]|64,i[8]=63&i[8]|128,t)for(var l=0;l<16;++l)t[r+l]=i[l];return t||n(i)}},900:function(e,t,a){"use strict";a.r(t),a.d(t,"ReportSetup",(function(){return L}));var o=a(49),n=a(30),r=a(11),i=a(12),l=a(16),s=a(17),c=a(37),d=a.n(c),u=a(369),p=a(452),m=a(479),f=(a(372),a(860)),h=a(482),y=a(672),g=a(370),v=a(368),E=a.n(v),b=a(271),I=a(483),C=a.n(I),j=a(371),S=(a(377),a(272)),w=function(e){Object(l.a)(a,e);var t=Object(s.a)(a);function a(e){var o;return Object(r.a)(this,a),(o=t.call(this,e)).OnNotification=function(e,t){Object(b.a)({message:e,type:t,displayTime:3e3,position:{at:"top right",offset:"50"}})},o.onLoadPanelHiding=function(e,t){o.setState({LoadPanelVisible:!1}),o.OnNotification(e,t)},o.OnSaveValidation=function(){return o.FormLayout.validate().isValid?!(!o.state.File&&!o.props.FileInfo.AutoID)||(o.OnNotification("File required","error"),!1):(o.OnNotification("Fields marked with * are required","error"),!1)},o.OnClickEvent=function(e){o.OnSaveValidation()&&(o.state.File?o.setState({LoadPanelVisible:!0},(function(){var e=new FormData;e.append("file",o.state.File);var t=o.props.FileInfo.AutoID?o.props.FileInfo.FileName:C.a.v4()+"."+/(?:\.([^.]+))?$/.exec(o.state.File.name)[1];E.a.post("/api/upload",e,{params:{Folder:"report",FileName:t}}).then((function(e){o.setState({File:null}),o.onSaveFileData(t),o.props.OnHide(1)})).catch((function(e){console.log(e),o.onLoadPanelHiding("Something went wrong","error")}))})):o.props.FileInfo.AutoID?(o.onSaveFileData(o.props.FileInfo.FileName),o.props.OnHide(1)):(o.onLoadPanelHiding("File not found","error"),o.props.OnHide(0)))},o.onSaveFileData=function(e){o.props.FileInfo.ParameterID&&(o.props.FileInfo.ParameterID=""+o.props.FileInfo.ParameterID),E.a.post("/api/report-layout",{LayoutID:o.props.FileInfo.AutoID?o.props.FileInfo.AutoID:0,LayoutName:e,Layout:JSON.stringify(o.props.FileInfo),Parameter:JSON.stringify(o.props.ParameterList),UserID:void 0==o.props.data.user?o.props.data.data.user.Id:o.props.data.user.Id}).then((function(e){o.onLoadPanelHiding("Successfully Saved","success")})).catch((function(e){console.log(e)}))},o.onCloseClick=function(e){o.props.OnHide(0)},o.FileSelect=function(e){o.setState({File:e.target.files[0]})},o.onSchoolValueChanged=function(e){console.log(o.props.Category),o.setState({jlSubModule:o.props.Category.filter((function(t){return t.SchoolID===e.value}))})},o.onGradeMoveClick=function(e,t){o.props.onGradeMoveClick(e,t)},o.state={File:null,FileName:null,jlSubModule:[],jParameter:[],LoadPanelVisible:!1},o.Status=[{ID:1,Name:"Active"},{ID:0,Name:"Inactive"}],o.Option=[{ID:1,Name:"Yes"},{ID:0,Name:"No"}],o.Type=[{ID:"dxTextBox",Name:"Text"},{ID:"dxDateBox",Name:"Date"},{ID:"dxNumberBox",Name:"Integer "},{ID:"dxSelectBox",Name:"List"}],o.FormRef=d.a.createRef(),o}return Object(i.a)(a,[{key:"componentDidMount",value:function(){}},{key:"FormLayout",get:function(){return this.FormRef.current.instance}},{key:"render",value:function(){var e=this;return d.a.createElement(c.Fragment,null,d.a.createElement(m.a,{size:"xl",show:this.props.Show,onHide:this.onCloseClick,backdrop:"static",keyboard:!1},d.a.createElement(m.a.Header,{closeButton:!0},d.a.createElement(m.a.Title,null,"Report Layout")),d.a.createElement(m.a.Body,null,d.a.createElement(f.a,{body:!0},d.a.createElement(g.g,{ref:this.FormRef,formData:this.props.FileInfo,colCount:2},d.a.createElement(g.c,{dataField:"CategoryID",editorType:"dxSelectBox",editorOptions:{searchEnabled:!0,items:this.state.jlSubModule,displayExpr:"Name",valueExpr:"AutoID"}},d.a.createElement(g.d,{text:"Category"}),d.a.createElement(g.e,null)),d.a.createElement(g.c,{dataField:"Name",editorType:"dxTextBox",editorOptions:{maxLength:50}},d.a.createElement(g.e,null)),d.a.createElement(g.c,{dataField:"Status",editorType:"dxSelectBox",editorOptions:{searchEnabled:!0,items:this.Status,displayExpr:"Name",valueExpr:"ID"}},d.a.createElement(g.e,null)),d.a.createElement(g.c,{dataField:"Description",editorOptions:{maxLength:50}}),d.a.createElement(g.c,{dataField:"Query",colSpan:2,editorType:"dxTextArea",editorOptions:{height:90}})),d.a.createElement("br",null),d.a.createElement("div",null,d.a.createElement("input",{type:"file",name:"file",onChange:function(t){return e.FileSelect(t)}})),d.a.createElement("br",null),d.a.createElement(u.k,{id:"grid-parameter",keyExpr:"AutoID",dataSource:this.props.ParameterList,showBorders:!0,wordWrapEnabled:!0,allowSearch:!0,showColumnLines:!0,showRowLines:!1,rowAlternationEnabled:!0},d.a.createElement(u.b,{mode:"row",useIcons:!0,allowUpdating:!0,allowDeleting:!0,allowAdding:!0}),d.a.createElement(u.j,{visible:!0,placeholder:"Search..."}),d.a.createElement(u.a,{dataField:"Parameter"},d.a.createElement(g.e,null)),d.a.createElement(u.a,{dataField:"Type"},d.a.createElement(u.g,{dataSource:this.Type,valueExpr:"ID",displayExpr:"Name"}),d.a.createElement(g.e,{message:"Field required"})),d.a.createElement(u.a,{dataField:"Query"}),d.a.createElement(u.a,{type:"buttons",buttons:["edit","delete",{hint:"Move Up",icon:"upload",onClick:function(t){return e.onGradeMoveClick(t,"Up")}},{hint:"Move Down",icon:"download",onClick:function(t){return e.onGradeMoveClick(t,"Down")}}]}))),d.a.createElement(h.a,{bg:"light",variant:"light"},d.a.createElement(y.a,{variant:"secondary",icon:"feather icon-layers",onClick:this.OnClickEvent},"Upload"),d.a.createElement(y.a,{variant:"secondary",icon:"feather icon-layers",onClick:this.onCloseClick},"Close")))),d.a.createElement(j.a,{message:"Processing.... Please, wait...",shadingColor:"rgba(0,0,0,0.4)",onHiding:this.onLoadPanelHiding,visible:this.state.LoadPanelVisible,showIndicator:!0,shading:!0,showPane:!0,closeOnOutsideClick:!1,width:500}))}}]),a}(c.Component),N=Object(S.b)((function(e){return{data:e.loggedReducer}}))(w),L=function(e){Object(l.a)(a,e);var t=Object(s.a)(a);function a(e){var o;return Object(r.a)(this,a),(o=t.call(this,e)).onUploadVisible=function(e){return!e.row.isEditing},o.onUploadClick=function(e){o.state.jLayoutUpdate?o.setState({jLayout:{},jLayoutUpdate:!1},(function(){1===e&&E.a.get("/api/report-layout-list",{params:{UserID:o.props.data.user.Id}}).then((function(e){o.setState({jLayoutList:JSON.parse(e.data[0].List)})})).catch((function(e){console.log(e)}))})):o.setState({jLayout:e.row.data},(function(){var t=Object(n.a)(o.state.jParameterList);t=t.filter((function(t){return t.ReportID==e.row.data.AutoID})).map((function(e){return e})),o.setState({jParameter:t},(function(){o.setState({jLayoutUpdate:!0})}))}))},o.OnToolbarPreparing=function(e){e.toolbarOptions.items.push({location:"after",widget:"dxButton",options:{icon:"add",onClick:function(e){o.setState({jLayoutUpdate:!o.state.jLayoutUpdate})}}})},o.onGradeMoveClick=function(e,t){var a=o.state.jlParameter.filter((function(t){return t.IndexNo!==e.row.rowIndex+1})),n=o.state.jlParameter.filter((function(t){return t.IndexNo===e.row.rowIndex+1}));a.splice("Up"===t?0===e.row.rowIndex?0:e.row.rowIndex-1:e.row.rowIndex+1,0,n[0]),a.map((function(e,t,o){a[t].IndexNo=t+1})),o.setState({jlParameter:a})},o.state={jLayoutList:[],jlSchool:[],jlMainModule:[],jlSubModule:[],jlCategory:[],jlParameter:[],jLayout:{},jParameter:[],jParameterList:[],jLayoutUpdate:!1,DocReadOnly:!1},o.Status=[{ID:1,Name:"Yes"},{ID:0,Name:"No"}],o.LayoutRef=d.a.createRef(),o}return Object(i.a)(a,[{key:"componentDidMount",value:function(){var e=this;Promise.all([E.a.get("/api/school-lookup-byLoginUser",{params:{UserID:this.props.data.user.Id}}),E.a.get("/api/module-main"),E.a.get("/api/module-sub"),E.a.get("/api/report-layout-list",{params:{UserID:this.props.data.user.Id}}),E.a.get("/api/report-category-list"),E.a.get("/api/report-parameter-lookup")]).then((function(t){var a=Object(o.a)(t,6),n=a[0],r=a[1],i=(a[2],a[3]),l=a[4],s=a[5];e.setState({jlSchool:n.data,jlMainModule:r.data,jlCategory:l.data,jLayoutList:JSON.parse(i.data[0].List),jlParameter:s.data,jParameterList:JSON.parse(i.data[0].ListParameter),DocReadOnly:!1})})).catch((function(e){return console.log(e)}))}},{key:"onRowRemoved",value:function(e){E.a.delete("/api/report/".concat(e.data.AutoID)).then((function(e){console.log(e.data)})).catch((function(e){console.log(e)})),E.a.get("/api/file-delete",{params:{Folder:"layout",FileName:e.data.FileName}}).then((function(e){console.log(e.data)})).catch((function(e){console.log(e)}))}},{key:"render",value:function(){return d.a.createElement(c.Fragment,null,d.a.createElement(p.a,{title:"Report Layout Setup"},d.a.createElement(u.k,{id:"grid-layout",keyExpr:"AutoID",showBorders:!0,dataSource:this.state.jLayoutList,onToolbarPreparing:this.OnToolbarPreparing,onRowRemoved:this.onRowRemoved},d.a.createElement(u.d,{visible:!0}),d.a.createElement(u.j,{visible:!0}),d.a.createElement(u.e,{autoExpandAll:!0}),d.a.createElement(u.h,{defaultPageSize:100}),d.a.createElement(u.b,{mode:"popup",allowDeleting:!this.state.DocReadOnly,useIcons:!0},d.a.createElement(u.i,{title:"Layout",showTitle:!0})),d.a.createElement(u.a,{dataField:"CategoryID",caption:"Category"},d.a.createElement(u.g,{dataSource:this.state.jlCategory,displayExpr:"Name",valueExpr:"AutoID"})),d.a.createElement(u.a,{dataField:"Name"}),d.a.createElement(u.a,{dataField:"Status"},d.a.createElement(u.g,{dataSource:this.Status,displayExpr:"Name",valueExpr:"ID"})),d.a.createElement(u.a,{type:"buttons",buttons:["edit",{hint:"Upload",icon:"upload",visible:this.onUploadVisible,onClick:this.onUploadClick},"delete"]}))),d.a.createElement(N,{ref:this.LayoutRef,Show:this.state.jLayoutUpdate,OnHide:this.onUploadClick,FileInfo:this.state.jLayout,ParameterList:this.state.jParameter,MainModule:this.state.jlMainModule,SubModule:this.state.jlSubModule,School:this.state.jlSchool,Category:this.state.jlCategory,Parameter:this.state.jlParameter,onGradeMoveClick:this.onGradeMoveClick}))}}]),a}(c.Component);t.default=Object(S.b)((function(e){return{data:e.loggedReducer}}))(L)}}]);
//# sourceMappingURL=17.871c95f0.chunk.js.map