{"version":3,"sources":["App/components/MainCard.js","../../src/FileSaver.js","Forms/Inquiry/KPI.jsx"],"names":["MainCard","state","isOption","props","fullCard","collapseCard","loadCard","cardRemove","cardReloadHandler","setState","setInterval","cardRemoveHandler","fullScreenStyle","loader","cardHeaderRight","cardHeader","card","cardClass","this","className","alignRight","Toggle","id","Menu","as","Item","onClick","prevState","href","DEMO","BLANK_LINK","Header","Title","title","position","top","left","right","width","windowWidth","height","windowHeight","join","style","in","Body","backgroundColor","children","Component","console","status","MouseEvent","document","window","self","global","test","navigator","HTMLAnchorElement","b","name","location","setTimeout","f","autoBom","Blob","type","open","i","saveAs","module","KPI","useState","Status","index","SetIndex","departmentDetails","setDepartmentDetails","Choose","ID","Name","folder","Type","bidding","AuthorityLevel","authorityLevel","Warranty","warranty","setIsView","useEffect","fetchGroupDetails","authData","JSON","parse","localStorage","getItem","axios","get","params","UsersID","UserName","MenuID","checkAuthentication","data","length","UserView","all","then","spread","kpi","Department","dataArray","forEach","obj","UpdatedOn","Date","PRNumber","getSAPDetails","value","PONo","DocNum","PODate","DocDate","catch","error","log","CreateDateTime","dateTime","year","getFullYear","month","getMonth","toString","padStart","date","getDate","hours","getHours","minutes","getMinutes","formattedDateTime","showBorders","dataSource","allowColumnResizing","wordWrapEnabled","columnAutoWidth","hoverStateEnabled","onCellClick","e","rowIndex","onSaved","post","stringify","response","Swal","fire","icon","text","res","confirmButtonColor","confirmButtonText","onExporting","workbook","Workbook","worksheet","addWorksheet","exportDataGrid","component","customizeCell","options","excelCell","font","size","alignment","horizontal","xlsx","writeBuffer","buffer","enabled","visible","mode","allowUpdating","useIcons","buttons","dataField","caption","editorOptions","readOnly","dataType","valueExpr","displayExpr"],"mappings":"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","file":"static/js/30.1097d557.chunk.js","sourcesContent":["import React, { Component } from \"react\";\r\nimport { Dropdown, Card, Collapse } from \"react-bootstrap\";\r\nimport windowSize from \"react-window-size\";\r\n\r\nimport Aux from \"../../hoc/_Aux\";\r\nimport DEMO from \"../../store/constant\";\r\n\r\n{\r\n  /* <Card className=\"customCard\"></Card>\r\n\r\n.customCard: {\r\n    background: blue !important;\r\n} */\r\n}\r\nclass MainCard extends Component {\r\n  state = {\r\n    isOption: this.props.isOption,\r\n    fullCard: false,\r\n    collapseCard: false,\r\n    loadCard: false,\r\n    cardRemove: false,\r\n  };\r\n\r\n  cardReloadHandler = () => {\r\n    this.setState({ loadCard: true });\r\n    setInterval(() => {\r\n      this.setState({ loadCard: false });\r\n    }, 3000);\r\n  };\r\n\r\n  cardRemoveHandler = () => {\r\n    this.setState({ cardRemove: true });\r\n  };\r\n\r\n  render() {\r\n    let fullScreenStyle, loader, cardHeaderRight, cardHeader, cardColor;\r\n    let card = \"\";\r\n    let cardClass = [];\r\n\r\n    if (this.state.isOption) {\r\n      cardHeaderRight = (\r\n        <div className=\"card-header-right\">\r\n          <Dropdown alignRight={true} className=\"btn-group card-option\">\r\n            <Dropdown.Toggle id=\"dropdown-basic\" className=\"btn-icon\">\r\n              <i className=\"feather icon-more-horizontal\" />\r\n            </Dropdown.Toggle>\r\n            <Dropdown.Menu as=\"ul\" className=\"list-unstyled card-option\">\r\n              <Dropdown.Item\r\n                as=\"li\"\r\n                className=\"dropdown-item\"\r\n                onClick={() => {\r\n                  this.setState((prevState) => {\r\n                    return { fullCard: !prevState.fullCard };\r\n                  });\r\n                }}\r\n              >\r\n                <i\r\n                  className={\r\n                    this.state.fullCard\r\n                      ? \"feather icon-minimize\"\r\n                      : \"feather icon-maximize\"\r\n                  }\r\n                />\r\n                <a href={DEMO.BLANK_LINK}>\r\n                  {\" \"}\r\n                  {this.state.fullCard ? \"Restore\" : \"Maximize\"}{\" \"}\r\n                </a>\r\n              </Dropdown.Item>\r\n              <Dropdown.Item\r\n                as=\"li\"\r\n                className=\"dropdown-item\"\r\n                onClick={() => {\r\n                  this.setState((prevState) => {\r\n                    return { collapseCard: !prevState.collapseCard };\r\n                  });\r\n                }}\r\n              >\r\n                <i\r\n                  className={\r\n                    this.state.collapseCard\r\n                      ? \"feather icon-plus\"\r\n                      : \"feather icon-minus\"\r\n                  }\r\n                />\r\n                <a href={DEMO.BLANK_LINK}>\r\n                  {\" \"}\r\n                  {this.state.collapseCard ? \"Expand\" : \"Collapse\"}{\" \"}\r\n                </a>\r\n              </Dropdown.Item>\r\n              <Dropdown.Item\r\n                as=\"li\"\r\n                className=\"dropdown-item\"\r\n                onClick={this.cardReloadHandler}\r\n              >\r\n                <i className=\"feather icon-refresh-cw\" />\r\n                <a href={DEMO.BLANK_LINK}> Reload </a>\r\n              </Dropdown.Item>\r\n              <Dropdown.Item\r\n                as=\"li\"\r\n                className=\"dropdown-item\"\r\n                onClick={this.cardRemoveHandler}\r\n              >\r\n                <i className=\"feather icon-trash\" />\r\n                <a href={DEMO.BLANK_LINK}> Remove </a>\r\n              </Dropdown.Item>\r\n            </Dropdown.Menu>\r\n          </Dropdown>\r\n        </div>\r\n      );\r\n    }\r\n\r\n    cardHeader = (\r\n      <Card.Header>\r\n        <Card.Title as=\"h5\">{this.props.title}</Card.Title>\r\n        {cardHeaderRight}\r\n      </Card.Header>\r\n    );\r\n\r\n    if (this.state.fullCard) {\r\n      cardClass = [...cardClass, \"full-card\"];\r\n      fullScreenStyle = {\r\n        position: \"fixed\",\r\n        top: 0,\r\n        left: 0,\r\n        right: 0,\r\n        width: this.props.windowWidth,\r\n        height: this.props.windowHeight,\r\n      };\r\n    }\r\n\r\n    if (this.state.loadCard) {\r\n      cardClass = [...cardClass, \"card-load\"];\r\n      loader = (\r\n        <div className=\"card-loader\">\r\n          <i className=\"pct-loader1 anim-rotate\" />\r\n        </div>\r\n      );\r\n    }\r\n\r\n    if (this.state.cardRemove) {\r\n      cardClass = [...cardClass, \"d-none\"];\r\n    }\r\n\r\n    if (this.props.cardClass) {\r\n      cardClass = [...cardClass, this.props.cardClass];\r\n    }\r\n\r\n    card = (\r\n      <Card className={cardClass.join(\" \")} style={fullScreenStyle}>\r\n        {cardHeader}\r\n        <Collapse in={!this.state.collapseCard}>\r\n          <div>\r\n            <Card.Body style={{ backgroundColor: \"rgb(185, 210, 214)\" }}>\r\n              {this.props.children}\r\n            </Card.Body>\r\n          </div>\r\n        </Collapse>\r\n        {loader}\r\n      </Card>\r\n    );\r\n\r\n    return <Aux>{card}</Aux>;\r\n  }\r\n}\r\n\r\nexport default MainCard;\r\n","/*\n* FileSaver.js\n* A saveAs() FileSaver implementation.\n*\n* By Eli Grey, http://eligrey.com\n*\n* License : https://github.com/eligrey/FileSaver.js/blob/master/LICENSE.md (MIT)\n* source  : http://purl.eligrey.com/github/FileSaver.js\n*/\n\n// The one and only way of getting global scope in all environments\n// https://stackoverflow.com/q/3277182/1008999\nvar _global = typeof window === 'object' && window.window === window\n  ? window : typeof self === 'object' && self.self === self\n  ? self : typeof global === 'object' && global.global === global\n  ? global\n  : this\n\nfunction bom (blob, opts) {\n  if (typeof opts === 'undefined') opts = { autoBom: false }\n  else if (typeof opts !== 'object') {\n    console.warn('Deprecated: Expected third argument to be a object')\n    opts = { autoBom: !opts }\n  }\n\n  // prepend BOM for UTF-8 XML and text/* types (including HTML)\n  // note: your browser will automatically convert UTF-16 U+FEFF to EF BB BF\n  if (opts.autoBom && /^\\s*(?:text\\/\\S*|application\\/xml|\\S*\\/\\S*\\+xml)\\s*;.*charset\\s*=\\s*utf-8/i.test(blob.type)) {\n    return new Blob([String.fromCharCode(0xFEFF), blob], { type: blob.type })\n  }\n  return blob\n}\n\nfunction download (url, name, opts) {\n  var xhr = new XMLHttpRequest()\n  xhr.open('GET', url)\n  xhr.responseType = 'blob'\n  xhr.onload = function () {\n    saveAs(xhr.response, name, opts)\n  }\n  xhr.onerror = function () {\n    console.error('could not download file')\n  }\n  xhr.send()\n}\n\nfunction corsEnabled (url) {\n  var xhr = new XMLHttpRequest()\n  // use sync to avoid popup blocker\n  xhr.open('HEAD', url, false)\n  try {\n    xhr.send()\n  } catch (e) {}\n  return xhr.status >= 200 && xhr.status <= 299\n}\n\n// `a.click()` doesn't work for all browsers (#465)\nfunction click (node) {\n  try {\n    node.dispatchEvent(new MouseEvent('click'))\n  } catch (e) {\n    var evt = document.createEvent('MouseEvents')\n    evt.initMouseEvent('click', true, true, window, 0, 0, 0, 80,\n                          20, false, false, false, false, 0, null)\n    node.dispatchEvent(evt)\n  }\n}\n\n// Detect WebView inside a native macOS app by ruling out all browsers\n// We just need to check for 'Safari' because all other browsers (besides Firefox) include that too\n// https://www.whatismybrowser.com/guides/the-latest-user-agent/macos\nvar isMacOSWebView = _global.navigator && /Macintosh/.test(navigator.userAgent) && /AppleWebKit/.test(navigator.userAgent) && !/Safari/.test(navigator.userAgent)\n\nvar saveAs = _global.saveAs || (\n  // probably in some web worker\n  (typeof window !== 'object' || window !== _global)\n    ? function saveAs () { /* noop */ }\n\n  // Use download attribute first if possible (#193 Lumia mobile) unless this is a macOS WebView\n  : ('download' in HTMLAnchorElement.prototype && !isMacOSWebView)\n  ? function saveAs (blob, name, opts) {\n    var URL = _global.URL || _global.webkitURL\n    var a = document.createElement('a')\n    name = name || blob.name || 'download'\n\n    a.download = name\n    a.rel = 'noopener' // tabnabbing\n\n    // TODO: detect chrome extensions & packaged apps\n    // a.target = '_blank'\n\n    if (typeof blob === 'string') {\n      // Support regular links\n      a.href = blob\n      if (a.origin !== location.origin) {\n        corsEnabled(a.href)\n          ? download(blob, name, opts)\n          : click(a, a.target = '_blank')\n      } else {\n        click(a)\n      }\n    } else {\n      // Support blobs\n      a.href = URL.createObjectURL(blob)\n      setTimeout(function () { URL.revokeObjectURL(a.href) }, 4E4) // 40s\n      setTimeout(function () { click(a) }, 0)\n    }\n  }\n\n  // Use msSaveOrOpenBlob as a second approach\n  : 'msSaveOrOpenBlob' in navigator\n  ? function saveAs (blob, name, opts) {\n    name = name || blob.name || 'download'\n\n    if (typeof blob === 'string') {\n      if (corsEnabled(blob)) {\n        download(blob, name, opts)\n      } else {\n        var a = document.createElement('a')\n        a.href = blob\n        a.target = '_blank'\n        setTimeout(function () { click(a) })\n      }\n    } else {\n      navigator.msSaveOrOpenBlob(bom(blob, opts), name)\n    }\n  }\n\n  // Fallback to using FileReader and a popup\n  : function saveAs (blob, name, opts, popup) {\n    // Open a popup immediately do go around popup blocker\n    // Mostly only available on user interaction and the fileReader is async so...\n    popup = popup || open('', '_blank')\n    if (popup) {\n      popup.document.title =\n      popup.document.body.innerText = 'downloading...'\n    }\n\n    if (typeof blob === 'string') return download(blob, name, opts)\n\n    var force = blob.type === 'application/octet-stream'\n    var isSafari = /constructor/i.test(_global.HTMLElement) || _global.safari\n    var isChromeIOS = /CriOS\\/[\\d]+/.test(navigator.userAgent)\n\n    if ((isChromeIOS || (force && isSafari) || isMacOSWebView) && typeof FileReader !== 'undefined') {\n      // Safari doesn't allow downloading of blob URLs\n      var reader = new FileReader()\n      reader.onloadend = function () {\n        var url = reader.result\n        url = isChromeIOS ? url : url.replace(/^data:[^;]*;/, 'data:attachment/file;')\n        if (popup) popup.location.href = url\n        else location = url\n        popup = null // reverse-tabnabbing #460\n      }\n      reader.readAsDataURL(blob)\n    } else {\n      var URL = _global.URL || _global.webkitURL\n      var url = URL.createObjectURL(blob)\n      if (popup) popup.location = url\n      else location.href = url\n      popup = null // reverse-tabnabbing #460\n      setTimeout(function () { URL.revokeObjectURL(url) }, 4E4) // 40s\n    }\n  }\n)\n\n_global.saveAs = saveAs.saveAs = saveAs\n\nif (typeof module !== 'undefined') {\n  module.exports = saveAs;\n}\n","import React, { useState, useEffect } from \"react\";\r\nimport Card from \"../../App/components/MainCard\";\r\nimport DataGrid, {\r\n  Column,\r\n  Editing,\r\n  Lookup,\r\n  Paging,\r\n  SearchPanel,\r\n  Export,\r\n} from \"devextreme-react/data-grid\";\r\nimport axios from \"axios\";\r\nimport Swal from \"sweetalert2\";\r\n\r\nimport { Workbook } from \"exceljs\";\r\nimport saveAs from \"file-saver\";\r\nimport { exportDataGrid } from \"devextreme/excel_exporter\";\r\n\r\nconst KPI = () => {\r\n  const [state, setState] = useState({\r\n    KPI: [],\r\n    Status: [],\r\n  });\r\n  const [index, SetIndex] = useState(0);\r\n  const [departmentDetails, setDepartmentDetails] = useState([]);\r\n  const [folder, setFolder] = useState({\r\n    Choose: [\r\n      { ID: \"N/A\", Name: \"N/A\" },\r\n      { ID: \"Archived\", Name: \"Archived\" },\r\n      {\r\n        ID: \"AllowToFeedFurtherToAMP/MP\",\r\n        Name: \"Allow to feed further to AMP/MP\",\r\n      },\r\n    ],\r\n  });\r\n\r\n  const [bidding, setBidding] = useState({\r\n    Type: [\r\n      { ID: \"Shopping\", Name: \"Shopping\" },\r\n      { ID: \"LNB\", Name: \"LNB\" },\r\n      { ID: \"NCB\", Name: \"NCB\" },\r\n      { ID: \"ICB\", Name: \"ICB\" },\r\n      { ID: \"Direct\", Name: \"Direct\" },\r\n      { ID: \"Repeat\", Name: \"Repeat\" },\r\n    ],\r\n  });\r\n\r\n  const [authorityLevel, setAuthorityLevel] = useState({\r\n    AuthorityLevel: [\r\n      { ID: \"HOD/P\", Name: \"HOD/P\" },\r\n      { ID: \"FM\", Name: \"FM\" },\r\n      { ID: \"GCOO\", Name: \"GCOO\" },\r\n      { ID: \"GCFO\", Name: \"GCFO\" },\r\n      { ID: \"DCEO\", Name: \"DCEO\" },\r\n      { ID: \"GCEO\", Name: \"GCEO\" },\r\n      { ID: \"PC\", Name: \"PC\" },\r\n      { ID: \"BOD\", Name: \"BOD\" },\r\n    ],\r\n  });\r\n\r\n  const [warranty, setWarranty] = useState({\r\n    Warranty: [\r\n      { ID: 1, Name: \"1 Year\" },\r\n      { ID: 2, Name: \"2 Year\" },\r\n      { ID: 3, Name: \"3 Year\" },\r\n      { ID: 4, Name: \"4 Year\" },\r\n      { ID: 5, Name: \"5 Year\" },\r\n      { ID: 6, Name: \"6 Year\" },\r\n      { ID: 7, Name: \"7 Year\" },\r\n      { ID: 8, Name: \"8 Year\" },\r\n      { ID: 9, Name: \"9 Year\" },\r\n      { ID: 10, Name: \"10 Year\" },\r\n    ],\r\n  });\r\n  const [isView, setIsView] = useState(true);\r\n\r\n  useEffect(() => {\r\n    fetchGroupDetails();\r\n  }, []);\r\n  const fetchGroupDetails = async () => {\r\n    const authData = JSON.parse(localStorage.getItem(\"user\"));\r\n    const checkAuthentication = await axios.get(\r\n      \"/api/CheckUserAuthentication\",\r\n      {\r\n        params: { UsersID: authData.UserName, MenuID: 1107 },\r\n      }\r\n    );\r\n    if (checkAuthentication.data.length != 0) {\r\n      if (checkAuthentication.data[0].UserView) {\r\n        setIsView(false);\r\n        try {\r\n          axios\r\n            .all([\r\n              axios.get(\"/api/getKPI\"),\r\n              axios.get(\"/api/getStatus\"),\r\n              axios.get(\"/api/getDepartment\"),\r\n            ])\r\n            .then(\r\n              axios.spread(async (kpi, status, Department) => {\r\n                if (kpi.data.length != 0) {\r\n                  let dataArray = kpi.data;\r\n                  dataArray.forEach(async (obj) => {\r\n                    obj.UpdatedOn = new Date();\r\n                    const getSAPDetails = await axios.get(\r\n                      \"/api/getSAPDetails\",\r\n                      {\r\n                        params: { PRNumber: obj.PRNumber },\r\n                      }\r\n                    );\r\n                    if (getSAPDetails.data.value.length != 0) {\r\n                      obj.PONo = getSAPDetails.data.value[0].DocNum;\r\n                      obj.PODate = getSAPDetails.data.value[0].DocDate;\r\n                      setState({\r\n                        KPI: dataArray,\r\n                        Status: status.data,\r\n                      });\r\n                    }\r\n                  });\r\n                  setState({\r\n                    KPI: dataArray,\r\n                    Status: status.data,\r\n                  });\r\n                  setDepartmentDetails(Department.data);\r\n                }\r\n              })\r\n            )\r\n            .catch((error) => console.error(error));\r\n        } catch (error) {\r\n          console.log(error);\r\n        }\r\n      }\r\n    }\r\n  };\r\n  const getIndex = (e) => {\r\n    SetIndex(e.rowIndex);\r\n  };\r\n\r\n  const onClickSave = (e) => {\r\n    axios\r\n      .post(\"/api/KPI\", {\r\n        KPI: JSON.stringify(state.KPI[index]),\r\n      })\r\n      .then((response) => {\r\n        console.log(response.data);\r\n        Swal.fire({\r\n          icon: \"success\",\r\n          title: \"Success\",\r\n          text: \"Saved Successfully!\",\r\n        }).then(async (res) => {});\r\n      })\r\n      .catch((error) => {\r\n        console.error(\"Error:\", error);\r\n        Swal.fire({\r\n          icon: \"error\",\r\n          title: '<span style=\"color: red;\">Error!</span>',\r\n          text: \"Failed to save KPI details\",\r\n          confirmButtonColor: \"#d33\",\r\n          confirmButtonText: \"OK\",\r\n        });\r\n      });\r\n  };\r\n\r\n  const onExporting = async (e) => {\r\n    let date = await CreateDateTime(new Date());\r\n    const workbook = new Workbook();\r\n    const worksheet = workbook.addWorksheet(\"Main sheet\");\r\n    exportDataGrid({\r\n      component: e.component,\r\n      worksheet: worksheet,\r\n      customizeCell: function (options) {\r\n        options.excelCell.font = { name: \"Arial\", size: 12 };\r\n        options.excelCell.alignment = { horizontal: \"left\" };\r\n      },\r\n    }).then(function () {\r\n      workbook.xlsx.writeBuffer().then(function (buffer) {\r\n        saveAs(\r\n          new Blob([buffer], { type: \"application/octet-stream\" }),\r\n          \"KPI List \" + date + \".xlsx\"\r\n        );\r\n      });\r\n    });\r\n  };\r\n\r\n  const CreateDateTime = (dateTime) => {\r\n    const year = dateTime.getFullYear();\r\n    const month = (dateTime.getMonth() + 1).toString().padStart(2, \"0\");\r\n    const date = dateTime.getDate().toString().padStart(2, \"0\");\r\n    const hours = dateTime.getHours().toString().padStart(2, \"0\");\r\n    const minutes = dateTime.getMinutes().toString().padStart(2, \"0\");\r\n    const formattedDateTime = `${year}.${month}.${date}.${hours}:${minutes}`;\r\n    console.log(formattedDateTime);\r\n    return formattedDateTime;\r\n  };\r\n\r\n  return (\r\n    <div>\r\n      <Card title=\"KPI\">\r\n        <DataGrid\r\n          // allowColumnReordering={true}\r\n          height={\"750\"}\r\n          showBorders={true}\r\n          dataSource={state.KPI}\r\n          allowColumnResizing={true}\r\n          wordWrapEnabled={true}\r\n          columnAutoWidth={true}\r\n          hoverStateEnabled={true}\r\n          onCellClick={getIndex}\r\n          onSaved={onClickSave}\r\n          onExporting={onExporting}\r\n        >\r\n          <Paging enabled={true} />\r\n          <SearchPanel visible={true} />\r\n          <Export enabled={true} />\r\n          <Editing mode=\"row\" allowUpdating={true} useIcons={true} />\r\n          <Column type=\"buttons\" buttons={[\"edit\"]} />\r\n          <Column\r\n            dataField=\"PRNumber\"\r\n            caption=\"PR Number\"\r\n            editorOptions={{ readOnly: true }}\r\n          />\r\n          <Column\r\n            dataField=\"CreatedDate\"\r\n            dataType=\"date\"\r\n            editorOptions={{ readOnly: true }}\r\n          />\r\n          <Column\r\n            dataField=\"ProcurementOfficer\"\r\n            editorOptions={{ readOnly: true }}\r\n          />\r\n          <Column dataField=\"FileNo\" editorOptions={{ readOnly: true }} />\r\n          <Column dataField=\"CurrentStatus\">\r\n            <Lookup\r\n              dataSource={state.Status}\r\n              valueExpr=\"ID\"\r\n              displayExpr=\"Status\"\r\n            ></Lookup>\r\n          </Column>\r\n          <Column dataField=\"Quantity\" editorOptions={{ readOnly: true }} />\r\n          <Column\r\n            dataField=\"UpdatedOn\"\r\n            dataType=\"date\"\r\n            editorOptions={{ readOnly: true }}\r\n          />\r\n          <Column\r\n            dataField=\"CallUpDate\"\r\n            dataType=\"date\"\r\n            caption=\"Call Update\"\r\n          />\r\n          <Column dataField=\"LocationFolder\" caption=\"Location/Folder\">\r\n            <Lookup\r\n              dataSource={folder.Choose}\r\n              valueExpr=\"ID\"\r\n              displayExpr=\"Name\"\r\n            ></Lookup>\r\n          </Column>\r\n          <Column dataField=\"ArchivedBOXNo\" caption=\"Archived BOX No\" />\r\n          <Column\r\n            dataField=\"RequestorsDepartment\"\r\n            caption=\"Department\"\r\n            readOnly={true}\r\n          >\r\n            <Lookup\r\n              dataSource={departmentDetails}\r\n              valueExpr=\"DepartmentCode\"\r\n              displayExpr=\"Discription\"\r\n            ></Lookup>\r\n          </Column>\r\n          <Column dataField=\"TypeOfbidding\" caption=\"Type Of Bidding\">\r\n            <Lookup\r\n              dataSource={bidding.Type}\r\n              valueExpr=\"ID\"\r\n              displayExpr=\"Name\"\r\n            ></Lookup>\r\n          </Column>\r\n          <Column\r\n            dataField=\"BidCalledOn\"\r\n            caption=\"CID Called On\"\r\n            dataType=\"date\"\r\n          />\r\n          <Column\r\n            dataField=\"BIDClosingON\"\r\n            caption=\"CID Closing On\"\r\n            dataType=\"date\"\r\n          />\r\n          <Column\r\n            dataField=\"SubmittedEvaluation\"\r\n            caption=\"Submitted for Evaluation On\"\r\n            dataType=\"date\"\r\n          />\r\n          <Column\r\n            dataField=\"TECReport\"\r\n            caption=\"TEC Report/Recommendation received On\"\r\n            dataType=\"date\"\r\n          />\r\n          <Column dataField=\"NegotiationDoneOn\" dataType=\"date\" />\r\n          <Column dataField=\"ApproveLevel\" caption=\"Authority Level (final)\">\r\n            <Lookup\r\n              dataSource={authorityLevel.AuthorityLevel}\r\n              valueExpr=\"ID\"\r\n              displayExpr=\"Name\"\r\n            ></Lookup>\r\n          </Column>\r\n          <Column\r\n            dataField=\"FinalApprovalReceivedON\"\r\n            caption=\"Final Approval Received On\"\r\n            dataType=\"date\"\r\n          />\r\n          <Column\r\n            dataField=\"PONo\"\r\n            caption=\"PO No\"\r\n            editorOptions={{ readOnly: true }}\r\n          />\r\n          <Column\r\n            dataField=\"PODate\"\r\n            caption=\"PO Date\"\r\n            dataType=\"date\"\r\n            editorOptions={{ readOnly: true }}\r\n          />\r\n          <Column\r\n            dataField=\"GoodsReceivedOn\"\r\n            editorOptions={{ readOnly: true }}\r\n          />\r\n          <Column dataField=\"WarrantyIfAny\" caption=\"Warranty If Any\">\r\n            <Lookup\r\n              dataSource={warranty.Warranty}\r\n              valueExpr=\"ID\"\r\n              displayExpr=\"Name\"\r\n            ></Lookup>\r\n          </Column>\r\n          <Column\r\n            dataField=\"PerformanceBondExpiryON\"\r\n            caption=\"Performance Bond Expiry On\"\r\n            dataType=\"date\"\r\n          />\r\n          <Column\r\n            dataField=\"RemarksKPI\"\r\n            caption=\"Remarks\"\r\n            dataType=\"TextArea\"\r\n          />\r\n        </DataGrid>\r\n      </Card>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default KPI;\r\n"],"sourceRoot":""}