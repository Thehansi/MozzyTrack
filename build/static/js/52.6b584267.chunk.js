/*! For license information please see 52.6b584267.chunk.js.LICENSE.txt */
(this["webpackJsonpdatta-able-rv18.0.4"]=this["webpackJsonpdatta-able-rv18.0.4"]||[]).push([[52],{566:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return l}));var r="object"===typeof window&&window.window===window?window:"object"===typeof self&&self.self===self?self:"object"===typeof e&&e.global===e?e:void 0;function o(e,t,n){var r=new XMLHttpRequest;r.open("GET",e),r.responseType="blob",r.onload=function(){l(r.response,t,n)},r.onerror=function(){console.error("could not download file")},r.send()}function a(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch(n){}return t.status>=200&&t.status<=299}function i(e){try{e.dispatchEvent(new MouseEvent("click"))}catch(n){var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var c=r.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),l=r.saveAs||("object"!==typeof window||window!==r?function(){}:"download"in HTMLAnchorElement.prototype&&!c?function(e,t,n){var c=r.URL||r.webkitURL,l=document.createElement("a");t=t||e.name||"download",l.download=t,l.rel="noopener","string"===typeof e?(l.href=e,l.origin!==location.origin?a(l.href)?o(e,t,n):i(l,l.target="_blank"):i(l)):(l.href=c.createObjectURL(e),setTimeout((function(){c.revokeObjectURL(l.href)}),4e4),setTimeout((function(){i(l)}),0))}:"msSaveOrOpenBlob"in navigator?function(e,t,n){if(t=t||e.name||"download","string"===typeof e)if(a(e))o(e,t,n);else{var r=document.createElement("a");r.href=e,r.target="_blank",setTimeout((function(){i(r)}))}else navigator.msSaveOrOpenBlob(function(e,t){return"undefined"===typeof t?t={autoBom:!1}:"object"!==typeof t&&(console.warn("Deprecated: Expected third argument to be a object"),t={autoBom:!t}),t.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob([String.fromCharCode(65279),e],{type:e.type}):e}(e,n),t)}:function(e,t,n,a){if((a=a||open("","_blank"))&&(a.document.title=a.document.body.innerText="downloading..."),"string"===typeof e)return o(e,t,n);var i="application/octet-stream"===e.type,l=/constructor/i.test(r.HTMLElement)||r.safari,s=/CriOS\/[\d]+/.test(navigator.userAgent);if((s||i&&l||c)&&"undefined"!==typeof FileReader){var u=new FileReader;u.onloadend=function(){var e=u.result;e=s?e:e.replace(/^data:[^;]*;/,"data:attachment/file;"),a?a.location.href=e:location=e,a=null},u.readAsDataURL(e)}else{var p=r.URL||r.webkitURL,d=p.createObjectURL(e);a?a.location=d:location.href=d,a=null,setTimeout((function(){p.revokeObjectURL(d)}),4e4)}});r.saveAs=l.saveAs=l}).call(this,n(252))},890:function(e,t,n){"use strict";n.r(t);var r=n(30),o=n(456),a=n(49),i=n(37),c=n.n(i),l=(n(409),n(460)),s=n.n(l),u=n(271),p=n(369),d=n(486),f=n(566),h=n(490),v=n(368),g=n.n(v),m=n(104);function y(){y=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,o=Object.defineProperty||function(e,t,n){e[t]=n.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",l=a.toStringTag||"@@toStringTag";function s(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(e){s=function(e,t,n){return e[t]=n}}function u(e,t,n,r){var a=t&&t.prototype instanceof g?t:g,i=Object.create(a.prototype),c=new C(r||[]);return o(i,"_invoke",{value:R(e,n,c)}),i}function p(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=u;var d="suspendedStart",f="executing",h="completed",v={};function g(){}function m(){}function w(){}var b={};s(b,i,(function(){return this}));var E=Object.getPrototypeOf,x=E&&E(E(P([])));x&&x!==n&&r.call(x,i)&&(b=x);var O=w.prototype=g.prototype=Object.create(b);function j(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function L(e,t){function n(o,a,i,c){var l=p(e[o],e,a);if("throw"!==l.type){var s=l.arg,u=s.value;return u&&"object"==typeof u&&r.call(u,"__await")?t.resolve(u.__await).then((function(e){n("next",e,i,c)}),(function(e){n("throw",e,i,c)})):t.resolve(u).then((function(e){s.value=e,i(s)}),(function(e){return n("throw",e,i,c)}))}c(l.arg)}var a;o(this,"_invoke",{value:function(e,r){function o(){return new t((function(t,o){n(e,r,t,o)}))}return a=a?a.then(o,o):o()}})}function R(t,n,r){var o=d;return function(a,i){if(o===f)throw new Error("Generator is already running");if(o===h){if("throw"===a)throw i;return{value:e,done:!0}}for(r.method=a,r.arg=i;;){var c=r.delegate;if(c){var l=A(c,r);if(l){if(l===v)continue;return l}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(o===d)throw o=h,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=f;var s=p(t,n,r);if("normal"===s.type){if(o=r.done?h:"suspendedYield",s.arg===v)continue;return{value:s.arg,done:r.done}}"throw"===s.type&&(o=h,r.method="throw",r.arg=s.arg)}}}function A(t,n){var r=n.method,o=t.iterator[r];if(o===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,A(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),v;var a=p(o,t.iterator,n.arg);if("throw"===a.type)return n.method="throw",n.arg=a.arg,n.delegate=null,v;var i=a.arg;return i?i.done?(n[t.resultName]=i.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,v):i:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,v)}function k(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function S(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function C(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(k,this),this.reset(!0)}function P(t){if(t||""===t){var n=t[i];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,a=function n(){for(;++o<t.length;)if(r.call(t,o))return n.value=t[o],n.done=!1,n;return n.value=e,n.done=!0,n};return a.next=a}}throw new TypeError(typeof t+" is not iterable")}return m.prototype=w,o(O,"constructor",{value:w,configurable:!0}),o(w,"constructor",{value:m,configurable:!0}),m.displayName=s(w,l,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===m||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,w):(e.__proto__=w,s(e,l,"GeneratorFunction")),e.prototype=Object.create(O),e},t.awrap=function(e){return{__await:e}},j(L.prototype),s(L.prototype,c,(function(){return this})),t.AsyncIterator=L,t.async=function(e,n,r,o,a){void 0===a&&(a=Promise);var i=new L(u(e,n,r,o),a);return t.isGeneratorFunction(n)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},j(O),s(O,l,"Generator"),s(O,i,(function(){return this})),s(O,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=P,C.prototype={constructor:C,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(S),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function o(r,o){return c.type="throw",c.arg=t,n.next=r,o&&(n.method="next",n.arg=e),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],c=i.completion;if("root"===i.tryLoc)return o("end");if(i.tryLoc<=this.prev){var l=r.call(i,"catchLoc"),s=r.call(i,"finallyLoc");if(l&&s){if(this.prev<i.catchLoc)return o(i.catchLoc,!0);if(this.prev<i.finallyLoc)return o(i.finallyLoc)}else if(l){if(this.prev<i.catchLoc)return o(i.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return o(i.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=e,i.arg=t,a?(this.method="next",this.next=a.finallyLoc,v):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),v},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),S(n),v}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var o=r.arg;S(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:P(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),v}},t}t.default=function(){var e,t,n,l;Object(i.useEffect)((function(){I()}),[]);var v=Object(i.useState)([]),w=Object(a.a)(v,2),b=w[0],E=w[1],x=Object(i.useState)(0),O=Object(a.a)(x,2),j=O[0],L=O[1],R=Object(i.useState)([]),A=Object(a.a)(R,2),k=A[0],S=A[1],C=Object(i.useState)(!0),P=Object(a.a)(C,2),U=(P[0],P[1]),H=Object(m.g)(),I=function(){return(e=e||Object(o.a)(y().mark((function e(){var t,n,r;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=JSON.parse(localStorage.getItem("user")),e.next=3,g.a.get("/api/CheckUserAuthentication",{params:{UsersID:t.UserName,MenuID:1103}});case 3:if(0!=(n=e.sent).data.length&&n.data[0].UserView){U(!1);try{g.a.all([g.a.get("/api/getUserGroup",{params:{UserName:t.UserName}}),g.a.get("/api/getUserGroupAprrovalLevel",{params:{UserName:t.UserName}})]).then(g.a.spread((function(e,n){return(r=r||Object(o.a)(y().mark((function e(n,r){var o,a,i;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0==n.data.length){e.next=13;break}return e.next=3,g.a.get("/api/getAllRequisitionItemList",{params:{EnterUser:t.UserName,UserGroup:n.data[0].UserGroup}});case 3:return o=e.sent,console.log("allPR",o),e.next=7,g.a.get("/api/getUserGroupAprrovalLevel",{params:{UserGroup:n.data[0].UserGroup}});case 7:a=e.sent,S(a.data),(i=o.data).forEach((function(e){e.Approved=!1,e.Rejected=!1,e.Cancel=!1,e.Pending=!1,e.Hold=!1})),i.forEach((function(e){switch(parseInt(e.ApproveStatus)){case 0:e.Pending=!0;break;case 1:e.Cancel=!0,e.ApproveLevel=null;break;case 2:e.Approved=!0,e.ApproveLevel=null;break;case 3:e.Rejected=!0,e.ApproveLevel=null;break;case 4:e.Hold=!0}})),E(i);case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}))).catch((function(e){return console.error(e)}))}catch(a){console.log(a)}}case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)},F=function(){return console.log("index",b[j]),""!=b[j].ApproveLevel&&void 0!=b[j].ApproveLevel||(e="Approval Level is Required",t="error",Object(u.a)({message:e,type:t,displayTime:3e3,position:{at:"top right",offset:"50"}}),!1);var e,t},D=function(){return(n=n||Object(o.a)(y().mark((function e(){var t,n,r;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.a.get("/api/getPurchaseRequisitionHeader",{params:{PRHeaderID:b[j].PRHeaderID}});case 2:return n=e.sent,e.next=5,g.a.get("/api/getPurchaseRequisitionItems",{params:{PRHeaderID:b[j].PRHeaderID}});case 5:r=e.sent,g.a.post("/api/PurchesRequest-sync",{PurchaseRequisitionHeader:n.data[0],PurchaseRequisitionItems:r.data}).then((function(e){return(t=t||Object(o.a)(y().mark((function e(t){return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.data.error?console.error("Error:",t.data.error):window.location.reload();case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)})).catch((function(e){console.log(e),console.error("Error:",e)}));case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)},T=function(e){var t=e.getFullYear(),n=(e.getMonth()+1).toString().padStart(2,"0"),r=e.getDate().toString().padStart(2,"0"),o=e.getHours().toString().padStart(2,"0"),a=e.getMinutes().toString().padStart(2,"0"),i="".concat(t,".").concat(n,".").concat(r,".").concat(o,":").concat(a);return console.log(i),i},N="2px solid #000000",_="#ffffff",G=function(e){if(e){var t=e.querySelector(".dx-checkbox-icon"),n=e.querySelector(".dx-checkbox-checked .dx-checkbox-icon");t&&(t.style.border=N),n&&(n.style.backgroundColor=_,n.style.borderColor=N)}};return c.a.createElement("div",null,c.a.createElement(p.k,{dataSource:b,showBorders:!0,allowColumnResizing:!0,wordWrapEnabled:!0,hoverStateEnabled:!0,columnAutoWidth:!0,onCellDblClick:function(e){return(t=t||Object(o.a)(y().mark((function e(t){var n;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.data,H.push({pathname:"/forms/Purchase-Request/Purchase-Request",state:{data:n,isPD:!0,rowIndex:t.data.rowIndex}});case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)},onCellClick:function(e){console.log(e.rowIndex),L(e.rowIndex)},onSaved:function(e){var t;F()&&(b[j].Approved?t=2:b[j].Cancel?t=1:b[j].Hold?t=4:b[j].Pending?t=0:b[j].Rejected&&(t=3),console.log("IsFinal",b[j]),console.log("ApproveStatus",t),g.a.post("/api/updateApproval",{ApproveStatus:t,ApproveLevel:b[j].ApproveLevel,ApproveRemarks:b[j].ApproveRemarks,PRHeaderID:b[j].PRHeaderID}).then((function(e){var n;console.log(e.data);g.a.post("/api/updateRequest",{ApproveStatus:t,PRHeaderID:b[j].PRHeaderID});s.a.fire({icon:"success",title:"Success",text:"Saved Successfully!"}).then((function(e){return(n=n||Object(o.a)(y().mark((function e(t){return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:b[j].IsFinal?D():window.location.reload();case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}))})).catch((function(e){console.error("Error:",e),s.a.fire({icon:"error",title:'<span style="color: red;">Error!</span>',text:"Failed to save document details",confirmButtonColor:"#d33",confirmButtonText:"OK"})})))},onExporting:function(e){return(l=l||Object(o.a)(y().mark((function e(t){var n,r,o;return y().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,T(new Date);case 2:n=e.sent,r=new d.Workbook,o=r.addWorksheet("Main sheet"),Object(h.a)({component:t.component,worksheet:o,customizeCell:function(e){e.excelCell.font={name:"Arial",size:12},e.excelCell.alignment={horizontal:"left"}}}).then((function(){r.xlsx.writeBuffer().then((function(e){Object(f.a)(new Blob([e],{type:"application/octet-stream"}),"Pending Documents "+n+".xlsx")}))}));case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},c.a.createElement(p.b,{mode:"row",allowUpdating:!0,useIcons:!0}),c.a.createElement(p.c,{enabled:!0}),c.a.createElement(p.a,{type:"buttons",buttons:["edit"]}),c.a.createElement(p.a,{dataField:"PRNumber",caption:"PR Number",editorOptions:{readOnly:!0}}),c.a.createElement(p.a,{dataField:"ApproveLevel",caption:"Current Approval Level"},c.a.createElement(p.g,{dataSource:k,valueExpr:"ApprovalLevel",displayExpr:"ApprovalLevel"})),c.a.createElement(p.a,{dataField:"CreatedDate",dataType:"date",caption:"Create Date"}),c.a.createElement(p.a,{dataField:"PRType",caption:"PR Type",editorOptions:{readOnly:!0}}),c.a.createElement(p.a,{dataField:"RequestorName",editorOptions:{readOnly:!0}}),c.a.createElement(p.a,{dataField:"ApproveUser",caption:"Current Approved User",editorOptions:{readOnly:!0}}),c.a.createElement(p.a,{alignment:"center",caption:"Approve Status"},c.a.createElement(p.a,{dataField:"Approved",caption:"Approved",editorOptions:{onValueChanged:function(e){if(console.log(e),console.log(j),1==e.value){var t=Object(r.a)(b);t[j].Pending=!1,t[j].Cancel=!1,t[j].Rejected=!1,t[j].Hold=!1,t[j].Approved=!0,E(t)}},onContentReady:function(e){return G(e.element)}}}),c.a.createElement(p.a,{dataField:"Rejected",caption:"Rejected",editorOptions:{onContentReady:function(e){return G(e.element)},onValueChanged:function(e){if(1==e.value){var t=Object(r.a)(b);t[j].Pending=!1,t[j].Cancel=!1,t[j].Rejected=!0,t[j].Hold=!1,t[j].Approved=!1,E(t)}}}}),c.a.createElement(p.a,{dataField:"Cancel",caption:"Cancel",editorOptions:{onContentReady:function(e){return G(e.element)},onValueChanged:function(e){if(1==e.value){var t=Object(r.a)(b);t[j].Pending=!1,t[j].Cancel=!0,t[j].Rejected=!1,t[j].Hold=!1,t[j].Approved=!1,E(t)}}}}),c.a.createElement(p.a,{dataField:"Pending",caption:"Pending",editorOptions:{onContentReady:function(e){return G(e.element)},onValueChanged:function(e){if(1==e.value){var t=Object(r.a)(b);t[j].Pending=!0,t[j].Cancel=!1,t[j].Rejected=!1,t[j].Hold=!1,t[j].Approved=!1,E(t)}}}}),c.a.createElement(p.a,{dataField:"Hold",caption:"Hold",editorOptions:{onContentReady:function(e){return G(e.element)},onValueChanged:function(e){if(1==e.value){var t=Object(r.a)(b);t[j].Pending=!1,t[j].Cancel=!1,t[j].Rejected=!1,t[j].Hold=!0,t[j].Approved=!1,E(t)}}}})),c.a.createElement(p.a,{dataField:"Remarks"})))}}}]);
//# sourceMappingURL=52.6b584267.chunk.js.map